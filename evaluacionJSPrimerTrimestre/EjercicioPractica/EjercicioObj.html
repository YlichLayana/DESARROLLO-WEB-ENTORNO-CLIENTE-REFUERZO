<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <table>
      <tr>
        <td>
          <table>
            <tr>
              <td><label for="">Marca: </label></td>
              <td><input type="text" name="ficha" /></td>
            </tr>
            <tr>
              <td><label for="">Modelo</label></td>
              <td><input type="text" name="ficha" /></td>
            </tr>
            <tr>
              <td><label for="">Matricula: </label></td>
              <td><input type="text" name="ficha" disabled /></td>
            </tr>
            <tr>
              <td><label for="">kilometros: </label></td>
              <td><input type="text" id="born" /></td>
            </tr>
            <tr>
              <td><label for="">Propietario: </label></td>
              <td><input type="text" id="dead" /></td>
            </tr>
          </table>
        </td>
        <td><img src="ordenador.jpg" width="143" height="144" alt="" /></td>
      </tr>
      <tr>
        <td>
          <input
            type="button"
            value="AÃ‘ADIR"
            style="width: 40mm; height: 7mm"
            onclick="agregar()"
          />
        </td>
        <td>
          <input
            type="button"
            value="BUSCAR"
            style="width: 40mm; height: 7mm"
            onclick="buscar()"
          />
        </td>
      </tr>
      <tr>
        <td>
          <input
            type="button"
            value="ELIMINAR"
            style="width: 40mm; height: 7mm"
            onclick="removerCoche()"
          />
        </td>
        <td>
          <input
            type="button"
            value="LIMPIAR"
            style="width: 40mm; height: 7mm"
            onclick="limpiar()"
          />
        </td>
      </tr>
      <tr>
        <td>
          <input
            type="button"
            value="TERMINAR"
            style="width: 40mm; height: 7mm"
            onclick="cancelarOTerminar()"
          />
        </td>
      </tr>
    </table>

    <script>
      var coches = [];

      function Coches(
        marca,
        modelo,
        matricula,
        kilometros,
        propietario,
        imagen
      ) {
        this.marca = marca;
        this.modelo = modelo;
        this.matricula =
          marca.slice(0, 1) +
          Math.floor(Math.random() * (1000 - 0)) +
          propietario.slice(propietario.length - 3, propietario.length);
        this.kilometros = kilometros;
        this.propietario = propietario;
        this.imagen = imagen;
      }

      function agregar() {
        //o capturar de esta manera local al llamar la funcion
        var marca = document.getElementsByTagName("input")[0].value;
        var modelo = document.getElementsByTagName("input")[1].value;
        var matricula = document.getElementsByTagName("input")[2].value;
        var kilometros = document.getElementsByTagName("input")[3].value;
        if (kilometros == "") {
          kilometros = 0;
        }
        var propietario = document.getElementsByTagName("input")[4].value;

        var datosImagen = prompt("Introduce la inicial y el apellido");

        //instancia de objeto persona
        var nuevoCoche = new Coches(
          marca,
          modelo,
          matricula,
          kilometros,
          propietario,
          datosImagen
        );

        //agrego objeto coche al final del array eminencias
        coches.push(nuevoCoche);

        alert(coches[0].matricula); // muestro el dni en alert
        console.log(coches); // con este console vemos lo que se a agregado en el array
        limpiar(); // invocacion de la funcion que limpia las cajas de texto
      }

      function buscar() {
        //variable de busqueda por marca enviada en el formulario
        var marcaBusca = document.getElementsByTagName("input")[0].value;
        var tieneDato = false;

        /*Otro metodo nativo de JS es el find*/
        /*Pero en este caso devolver el primer elemento encontrado */
        if (marcaBusca != "") {
          tieneDato = true;
          var Buscado = coches.find(function (element) {
            return element.marca == marcaBusca;
          });
        }

        if (!tieneDato) {
          alert("Debe ingresar dato para buscar ");
        }
        console.log(Buscado);

        //para ver valores de objeto buscado con metodo find
        for (const key in Buscado) {
          document.getElementsByTagName("input")[0].value = Buscado.marca;
          document.getElementsByTagName("input")[1].value = Buscado.modelo;
          document.getElementsByTagName("input")[2].value = Buscado.matricula;
          document.getElementsByTagName("input")[3].value = Buscado.kilometros;
          document.getElementsByTagName("input")[4].value = Buscado.propietario;

          document.getElementsByTagName("img")[0].src = Buscado.imagen + ".jpg";
        }
      }

      //eliminar objeto coche
      function removerCoche() {
        var datoEliminar = document.getElementsByTagName("input")[0].value;

        if (datoEliminar !== "") {
          var Buscado = coches.find(function (element) {
            return element.marca == datoEliminar;
          });

        } else {
          alert("Error: Debes ingresar el Dato correcto");
        }

        if(Buscado!=undefined){
            coches.splice(Buscado, 1);
            alert("El coche elimino Correctamente");
        }
        else{
            alert("El coche no se piuede eliminar no esta en la lista");
        }
        
      }

      function limpiar() {
        for (let i = 0; i < 5; i++) {
          document.getElementsByTagName("input")[i].value = "";
        }
      }

      //function para cancelar o Terminar
    function cancelarOTerminar(){
            if(confirm("Desea Termiar o Cancelar?")){
                document.write("Adios")
            }
        }


    </script>
  </body>
</html>
